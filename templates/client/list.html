{% extends "body.html" %}

{% block title %}
    <title>Клиенты</title>
{% endblock %}

{% block content %}
    {% if errors %}
        {% for e in errors %}
            <div>{{ e }}</div>
        {% endfor %}
    {% endif %}
    <form style="display: none" class="form-horizontal" action="{% url 'client:search' %}" method="post">
            {% csrf_token %}
                        <div class="fieldWrapper">
                            {{ form.first_name }}
                            <label for="first_name">{{ form.first_name.label }}</label>
                        </div>
                        <div class="fieldWrapper">
                            {{ form.last_name }}
                            <label for="last_name"> {{ form.last_name.label }}</label>
                        </div>
                        <div class="fieldWrapper">
                            {{ form.passport_id }}
                            <label for="passport_id">{{ form.passport_id.label }}</label>
                        </div>

            <input class="btn btn-default" type="submit" value="Поиск" />
        </form>

    {% if clients %}

        <div class="table-responsive">
            <table class="table table-striped">
                <tr>
                    <td>ФИО</td>
                    <td>Идентификационный номер</td>
                    <td colspan="4"><span id="lastoperation" class="label label-success"></span></td>
                </tr>
                {% for client in clients %}
                    <tr>
                        <td id="client_{{ client.id }}">{{ client.get_full_name }}</td>
                        <td>{{ client.passport_id }}</td>
                        <td>

                            <a style="display: none;" href="" id="client_name_{{ client.id }}" data-toggle="modal"
                               data-target="#myModalChangeUser" data-father="{{ client.father_name }}"
                               data-last="{{ client.last_name }}" data-first="{{ client.first_name }}"
                               data-contentname="{{ client.get_full_name }}"
                               data-contentid="{{ client.id }}">Изменить
                            </a>
                        </td>
                        <td>
                            <a href="" data-toggle="modal"
                               data-target="#myModalMessage" data-contentname="{{ client.get_full_name }}"
                               data-contentid="{{ client.id }}">Отправить сообщение
                            </a>
                        </td>
                        <td>
                            <a href="" data-toggle="modal"
                               data-target="#myModalNewBill" data-contentname="{{ client.get_full_name }}"
                               data-contentid="{{ client.id }}">Новый счёт
                            </a>
                        </td>
                        <td>
                            <a href="" type="button" data-toggle="modal"
                               data-target="#myModalFill" data-contentname="{{ client.get_full_name }}"
                               data-contentid="{{ client.id }}">Пополнить счёт
                            </a>
                        </td>
                        <td style="display: none">
                            <a data-toggle="modal"
                               data-target="#myModalNewCard" data-contentname="{{ client.get_full_name }}"
                               data-contentid="{{ client.id }}">Новая карточка
                            </a>

                        </td>
                    </tr>

                {% endfor %}
            </table>
        </div>


        {% include 'modals/client_list.html' %}

        {% load staticfiles %}
        <script type="text/javascript" src="{% static "myjs/admin_client_list.js" %}"></script>


    {% endif %}
{% endblock %}