{% extends "body.html" %}

{% block title %}
    <title>Клиенты</title>
{% endblock %}

{% block content %}
    <table>
        <tr>
            <td colspan="3">Поиск</td>
        <tr>
            <td><input placeholder="Фамилия" name="last" type="text" id="search_last"></td>
            <td><input placeholder="Имя" name="first" type="text" id="search_first"></td>
            <td><input placeholder="Отчество" name="father" type="text" id="search_father"></td>
        </tr>
    </table>


    {% if clients %}
        <div id="searchresult" class="table-responsive">
            <table class="table table-bordered table-hover">
                <thead class="thead-inverse">
                <tr>
                    <th>ФИО</th>
                    <th>Идентификационный номер</th>
                    <th colspan="3"><span id="lastoperation" class="label label-success"></span></th>
                </tr>
                </thead>
                {% for client in clients %}
                    <tr>
                        <td id="client_{{ client.id }}">{{ client.get_full_name }}</td>
                        <td>{{ client.passport_id }}</td>
                        <td>
                            <a href="" data-toggle="modal"
                               data-target="#myModalMessage" data-contentname="{{ client.get_full_name }}"
                               data-contentid="{{ client.id }}">Отправить сообщение
                            </a>
                        </td>
                        <td>
                            <a href="" data-toggle="modal"
                               data-target="#myModalNewBill" data-contentname="{{ client.get_full_name }}"
                               data-contentid="{{ client.id }}">Новый счёт
                            </a>
                        </td>
                        <td>
                            <a href="" type="button" data-toggle="modal"
                               data-target="#myModalFill" data-contentname="{{ client.get_full_name }}"
                               data-contentid="{{ client.id }}">Пополнить счёт
                            </a>
                        </td>
                    </tr>

                {% endfor %}
            </table>
        </div>

        {% include 'modals/client_list.html' %}

        {% load staticfiles %}
        <script type="text/javascript" src="{% static "myjs/admin_client_list.js" %}"></script>
        <script type="text/javascript">
            $(document).foundation();
            jQuery(function ($) {
            });
        </script>

        <script type="text/javascript">
            $(function () {
                $("#search_first").keyup(function () {
                    var search_first = $("#search_first").val();
                    var search_last = $("#search_last").val();
                    var search_father = $("#search_father").val();
                    $.post('/client/search/', {
                        'first': search_first,
                        'last': search_last,
                        'father': search_father
                    }, function (data) {
                        $('#searchresult').html(data)
                    });
                    return false;
                });
                $("#search_last").keyup(function () {
                    var search_first = $("#search_first").val();
                    var search_last = $("#search_last").val();
                    var search_father = $("#search_father").val();
                    $.post('/client/search/', {
                        'first': search_first,
                        'last': search_last,
                        'father': search_father
                    }, function (data) {
                        $('#searchresult').html(data)
                    });
                    return false;
                });
                $("#search_father").keyup(function () {
                    var search_first = $("#search_first").val();
                    var search_last = $("#search_last").val();
                    var search_father = $("#search_father").val();
                    $.post('/client/search/', {
                        'first': search_first,
                        'last': search_last,
                        'father': search_father
                    }, function (data) {
                        $('#searchresult').html(data)
                    });
                    return false;
                });
            });
        </script>



    {% endif %}

{% endblock %}